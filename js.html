<!DOCTYPE html>
<html>
<head>
<script>
window.onload=inicio;
async function datos(){
    let url = 'http://localhost/decroly/consultas_php/json.php';
    let ps = await (await fetch(url,{mode:"no-cors"})).json();
	r='';
	if(1){	// Visitas en provincias
		for(i=0;i<ps.length;i++){
			r+='<div id="'+ps[i]['provincia']+'"';
			r+=' onclick="visita('+(i+1)+')"';
			r+='>';
			r+=ps[i]['visitas'];
			r+=' ';
			r+=ps[i]['provincia'];
			r+='</div>';
		}
	}
	//////////////////////////////////////////////
	if(0){	// Listado de provincias
		for(i=0;i<ps.length;i++)
			r+=ps[i]['provincia']+'<br/>';
	}
	if(0){	// ¿Cuánto suman 2 y 3?
		r = 2+3;
	}
	if(0){	// Densidades de población de las provincias
		for(i=0;i<ps.length;i++){
			r+=ps[i]['provincia']+' ';
			r+=(ps[i]['poblacion']/ps[i]['superficie']);
			r+='<br/>';
		}
	}
	if(0){	// Obtén el listado del nombre de las provincias que tiene cada autonomía
		for(i=0;i<ps.length;i++){
			r+=ps[i]['autonomia']+' ';
			r+=ps[i]['provincia'];
			r+='<br/>';
		}
	}
	if(0){	// ¿Cuánto vale la raíz cuadrada de 2?
		r = Math.sqrt(2);
	}
	if(0){	// ¿Cuántos caracteres tiene cada nombre de provincia?
		for(i=0;i<ps.length;i++){
			r+=ps[i]['provincia']+' ';
			r+=ps[i]['provincia'].length;
			r+='<br/>';
		}
	}
	//////////////////////////////////////////////
	document.getElementById("resultado").innerHTML=r;
	return ps;
}
function inicio(){
	datos();
	var timer = setInterval(datos, 1000);	// repetición indefinida hasta clearInterval(timer)
}
async function visita(id){
	let url = 'http://localhost/decroly/consultas_php/json.php?id='+id;
	let ps = await (await fetch(url,{mode:"no-cors"})).json();
	datos();
}
</script>
</head>
<body>
<div id="resultado"></div>
</body>
</html>